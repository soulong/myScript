/*
 * PDF Skill - Base CSS
 * 包含所有 HTML→PDF 转换中必须的基础样式。
 * 使用方法：<link rel="stylesheet" href="{WORKSPACE}/.minimax/skills/minimax-pdf/scripts/styles/base.css">
 * 其中 {WORKSPACE} 替换为实际工作区绝对路径
 */

/* ============================================================
   1. Page Setup
   ============================================================ */
@page {
    size: A4;
    margin: 2.5cm 2cm;
    @top-center { content: string(doctitle); font-size: 9pt; color: #666; }
    @bottom-center { content: counter(page); font-size: 9pt; }
}
@page :first {
    @top-center { content: none; }
    @bottom-center { content: none; }
}

/* Named pages: hide header/footer on cover and TOC */
@page cover { @top-center { content: none; } @bottom-center { content: none; } }
@page toc { @top-center { content: none; } @bottom-center { content: none; } }
.cover { page: cover; }
.toc-page { page: toc; }

/* Prevent "undefined" in header before h1 appears */
body { string-set: doctitle ""; }
h1 { string-set: doctitle content(); }

/* ============================================================
   2. Typography
   ============================================================ */
body {
    margin: 0;
    padding: 0;
    font-family: 'Noto Sans SC', 'Microsoft YaHei', 'Helvetica Neue', Arial, sans-serif;
    font-size: 11pt;
    line-height: 1.6;
    color: #333;
    text-align: justify;
    text-align-last: left;
}

h1, h2, h3, h4, h5, h6 {
    font-family: 'Noto Serif SC', Georgia, serif;
    color: #1a202c;
    page-break-after: avoid;
}

h1 { font-size: 20pt; margin: 1.5em 0 0.8em 0; }
h2 { font-size: 16pt; margin: 1.2em 0 0.6em 0; }
h3 { font-size: 13pt; margin: 1em 0 0.5em 0; }

p { margin: 0.8em 0; }

a { color: #2c5282; text-decoration: none; word-break: break-all; }

/* ============================================================
   3. Figure / Table / Equation Numbering (data-label)
   Only applies when data-label attribute is present.
   If AI bakes the label into text directly, no prefix is added.
   ============================================================ */
figcaption[data-label]::before {
    content: attr(data-label) ": ";
    font-weight: bold;
    color: #333;
}
caption[data-label]::before {
    content: attr(data-label) "  ";
    font-weight: bold;
    color: #333;
}
.equation[data-label]::after {
    content: attr(data-label);
    float: right;
}

/* ============================================================
   4. Figure & Table Styles
   ============================================================ */
figure {
    margin: 1.5em 0;
    page-break-inside: avoid;
    text-align: center;
}

figure img, figure svg {
    max-width: 80%;
    max-height: 40vh;
    height: auto;
}

figcaption {
    font-size: 10pt;
    color: #555;
    margin-top: 0.5em;
    text-align: left;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin: 1em 0;
    page-break-inside: avoid;
    overflow-x: auto;
}

caption {
    font-size: 10pt;
    font-weight: bold;
    text-align: left;
    margin-bottom: 0.5em;
}

/* Three-line table (booktabs style) */
thead { display: table-header-group; }
thead tr { border-top: 2px solid #333; border-bottom: 1px solid #333; }
tbody tr:last-child { border-bottom: 2px solid #333; }
th, td { padding: 6px 10px; text-align: left; }
th { font-weight: 600; background: #f7fafc; }

/* ============================================================
   5. Page Break Rules
   ============================================================ */
figure, .theorem, .algorithm { page-break-inside: avoid; }
tr { page-break-inside: avoid; }

/* ============================================================
   6. Overflow Prevention
   ============================================================ */
pre, table, figure, img, svg, .mermaid, blockquote, .equation {
    max-width: 100%;
    box-sizing: border-box;
}
pre { overflow-x: auto; white-space: pre-wrap; word-wrap: break-word; }
table { overflow-x: auto; }

.katex-display { overflow-x: auto; }
code { word-break: break-word; }

/* ============================================================
   7. Citation Styles
   ============================================================ */
a.cite {
    color: black;
    text-decoration: none;
    vertical-align: super;
    font-size: 0.75em;
}

.references li {
    padding-left: 2em;
    text-indent: -2em;
}

/* ============================================================
   8. Footnotes (Paged.js)
   ============================================================ */
.footnote-ref { float: footnote; }
.footnote-ref::footnote-call { content: counter(footnote); vertical-align: super; font-size: 0.75em; }
.footnote-ref::footnote-marker { content: counter(footnote) ". "; }
@page { @footnote { margin-top: 1em; border-top: 1px solid #ccc; padding-top: 0.5em; } }

/* ============================================================
   9. TOC Styles
   ============================================================ */
.toc a::after {
    content: leader('.') target-counter(attr(href url), page);
}
.toc a {
    text-decoration: none;
    color: #333;
}

/* ============================================================
   10. Cover Background Image Helper
   ============================================================ */
.cover-bg {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    object-fit: cover; object-position: center; z-index: 0;
}
